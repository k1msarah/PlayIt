<html>
<head>
	<title>CatchIt</title>
	<link rel="stylesheet" type="text/css" href="./../stylesheets/style.css">
</head>
<style type="text/css">


*{
	font-family:helvetica,arial,sans-serif;
	text-align:center;
}

#wrapper{
	width:540px;
	height:960px;
	margin:-10px -10px;
	border:1px solid green;
	background-image:url('./../images/catch/catch_background.png');
	/*background-color:#81DAF5;*/
	/*background: linear-gradient(#F78181, #F78181, #B40431);*/
}
#gameboard{
	margin:225px 0px;
	border:5px solid red;
}
#catch_icon{
	background: linear-gradient(#F78181, #FE2E2E, #F78181);
	border-radius:5px;
	border:2px solid #FF0000;
	height:75px;
	width:75px;
}
.lollypop{
	width:80px;
	height:130px;
}

.kid{
width:170px;
	height:200px;
}
#score{
	font-size: 40px;
	height:100px;
	border:4px solid white;
	color:white;
	vertical-align: top;

}
#score img{
	margin-top: -30px;
}

</style>
<body>
	<div id="wrapper">
		<div id="score">
			<div id="image">
			</div>
			
			<label>Score: </label>
			<label>Level: </label>
			<div id="word">
			</div>			
		</div>
		<div id="pop">	
		</div>	
			
		<div id="kid">				
		</div>
			

	</div>

</body>
<script>
function slice(array, index)
{	console.log(index);
    var result = [];
    for (var i = index || 0, j = 0; i < array.length; ++i, ++j)
        result[j] = array[i];
    return result;
}
function CatchIt()
{
	var elem = document.getElementById('pop');
	var girl = new Kid();
	this.word = new randomWord();
	this.counter = 0;
	this.lollipops = [];
	this.alphabets = this.word.spellWord();

	this.playGame = function()
	{
		this.makeLollipop();
		this.dropLollipops();
		this.updateLollipop();
		this.detectCollision();
	
	}
	//create a new lollipop and add it to the game
	this.makeLollipop = function()
	{
		this.counter++;

		var newLolli = new Lollipop(this.counter);
		newLolli.createRandomLollipop(0,460);

		this.lollipops.push(newLolli);

		elem.innerHTML += "<img class='lollypop' id='" + newLolli.id +"' src='./../images/catch/alphabets/"+newLolli.alphabet+".png' style='position:absolute;left:" + newLolli.x + " ;top:"+ newLolli.y +";'>";

	}
	this.dropLollipops = function()
	{
		for(var i=this.lollipops.length-1; i>=0; i--)
		{
			this.lollipops[i].y = this.lollipops[i].y + 10;
			if(this.lollipops[i].exist == true && this.lollipops[i].y > 580)
			{
				document.getElementById(this.lollipops[i].id).remove();
				this.lollipops[i].exist = false;
			}		
			
		}

	}
	this.updateLollipop = function()
	{
		for(i in this.lollipops){
			pop = document.getElementById(this.lollipops[i].id);
			if(pop)
			{
				pop.style.top = this.lollipops[i].y

			}
		}
	}
	this.checkLetter = function(letter)
	{	console.log(this.alphabets);
		for(i in this.alphabets)
		{			
			if(this.alphabets[i] == letter)
			{
				var result = document.getElementById('word')
				result.innerHTML += letter; 
			}
		}
	}		
	this.detectCollision = function()
	{ 
		
		for(i in this.lollipops){
			if(this.lollipops[i].exist == true){
				var delta_y = girl.info.top - (this.lollipops[i].y + 130)
				var lx = this.lollipops[i].x + 40;

				if(delta_y <= 0)
				{
					if(lx > girl.info.left && lx < girl.info.left + 85 )
					{
						var that = this.lollipops[i];
						this.checkLetter(this.lollipops[i].alphabet);
						document.getElementById(that.id).remove();
						 that.exist = false;
					}
				} 
			}	
		}
	}
	this.moveKid = function()
	{
		document.onkeydown = function(e)
		{
			if(e.keyCode == 37)
			{
				girl.info.left -= 15;
			}
			else if(e.keyCode == 39)
			{
				girl.info.left += 15;
			}
			girl.drawKid();
			
		}
	}

	this.word.drawImage();
	this.word.spellWord();	
	//this.makeLollipop();
	girl.drawKid();	
	this.moveKid();	

}

function Lollipop(id){

	var letter = ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'];
	this.x = 0;//Math.floor(Math.random()*360)+ 100;
	this.y = 120;
	this.id = id;
	this.alphabet = letter[Math.floor(Math.random()*26)];
	this.exist = true;

	this.createRandomLollipop = function(min, max)
	{
		random_x = Math.floor(Math.random()*(max-min+1)+min); 
		this.x = random_x 
	}


}


function Kid()
{		this.info = {
			top: 700,
			left: 215
		}
		this.drawKid = function()
		{
			var kid = document.getElementById('kid');		
			kid.innerHTML = "<img class='kid' src='./../images/catch/girl.png' style='position:absolute;  left:"+this.info.left+"px; top:"+this.info.top+"px;'>"
		}

}

function randomWord()
{		
	var words = [];
		this.word = 'dog';
		this.drawImage = function()
		{
			var image = document.getElementById('image');		
			image.innerHTML = "<img src='./../images/catch/words/Level1/"+this.word+".png' style='position:absolute; width:60; height:80; left:50px; top:50px; border:2px solid white;'>"
		}
		this.spellWord = function()
		{	var word = this.word.toUpperCase();
			 return word.split('');
			
		}

}		
	
document.onkeydown = function(event){
		if(event.keyCode === 37 || event.keyCode === 39){
			CatchIt.updateKid(event.keyCode)
		}
		else if(event.keyCode === 38){
			CatchIt.updateKid(event.keyCode)
		}
}

var game = new CatchIt();
//game.playGame();

setInterval('game.playGame()', 500);

</script>
</html>